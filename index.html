<!DOCTYPE html>
<html lang="fa" dir="rtl">
    <link rel="manifest" href="manifest.json">

    <script>
      // ï¿½1ï¿½0ï¿½1ï¿½9ï¿½1ï¿½9ï¿½1ï¿½1ï¿½1ï¿½4 ï¿½1ï¿½2ï¿½1ï¿½4ï¿½1ï¿½2ï¿½1ï¿½7 Service Worker ï¿½1ï¿½7ï¿½1ï¿½9 ï¿½1ï¿½9ï¿½1ï¿½9ï¿½1ï¿½2ï¿½1ï¿½9ï¿½1ï¿½5ï¿½1ï¿½9
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('/service-worker.js')
            .then(registration => {
              console.log('Service Worker registered! Scope:', registration.scope);
            })
            .catch(err => {
              console.log('Service Worker registration failed:', err);
            });
        });
      }
    </script>
</head>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ù†Ù„ Ø«Ø¨Øª Ú¯Ø²Ø§Ø±Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡ Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Vazirmatn', sans-serif;
        }
        
        .persian-input {
            direction: rtl;
            text-align: right;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #10b981, #059669);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #059669, #047857);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #3b82f6, #2563eb);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            transform: translateY(-1px);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .btn-warning:hover {
            background: linear-gradient(135deg, #d97706, #b45309);
            transform: translateY(-1px);
        }
        
        .form-container {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border: 1px solid #cbd5e1;
        }
        
        .input-field {
            background: white;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .input-field:focus {
            border-color: #10b981;
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .sidebar {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100vh;
            background: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            overflow-y: auto;
        }
        
        .sidebar.open {
            right: 0;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .overlay.show {
            opacity: 1;
            visibility: visible;
        }
        
        .login-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-green-50 to-blue-50 min-h-screen">
    <!-- Ø§Ø¹Ù„Ø§Ù† -->
    <div id="toast" class="toast bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg">
        <span id="toastMessage">Ø¹Ù…Ù„ÛŒØ§Øª Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯</span>
    </div>

    <!-- ØµÙØ­Ù‡ ÙˆØ±ÙˆØ¯ -->
    <div id="loginPage" class="login-container min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <h1 class="text-2xl font-bold text-gray-800 mb-2">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³Ø§Ù…Ø§Ù†Ù‡</h1>
                <p class="text-gray-600">ÙˆØ§Ø­Ø¯ Ù†ÛŒØ´Ú©Ø± Ø§Ù…Ø§Ù… Ø®Ù…ÛŒÙ†ÛŒ (Ø±Ù‡)</p>
            </div>
            
            <form id="loginForm" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ‘¤ Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
                    <input type="text" id="fullName" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="Ù†Ø§Ù… Ú©Ø§Ù…Ù„ Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ†” Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª Ù¾Ø±Ø³Ù†Ù„ÛŒ</label>
                    <input type="text" id="employeeId" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª Ù¾Ø±Ø³Ù†Ù„ÛŒ" required>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ” Ø±Ù…Ø² ÙˆØ±ÙˆØ¯</label>
                    <input type="password" id="password" class="input-field w-full px-4 py-3 rounded-lg" placeholder="Ø±Ù…Ø² ÙˆØ±ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" required>
                </div>
                
                <button type="submit" class="btn-primary w-full py-3 text-white font-medium rounded-lg">
                    ğŸšª ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³Ø§Ù…Ø§Ù†Ù‡
                </button>
            </form>
        </div>
    </div>

    <!-- Ø§ÙˆØ±Ù„ÛŒ Ù…Ù†Ùˆ -->
    <div id="overlay" class="overlay" onclick="closeSidebar()"></div>

    <!-- Ù…Ù†ÙˆÛŒ Ú©Ù†Ø§Ø±ÛŒ -->
    <div id="sidebar" class="sidebar">
        <div class="p-6 border-b border-gray-200">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-gray-800">Ù…Ù†Ùˆ</h2>
                <button onclick="closeSidebar()" class="text-gray-500 hover:text-gray-700">âœ„1ï¿½7</button>
            </div>
        </div>
        
        <div class="p-4">
            <div class="space-y-2">
                <button onclick="showUserInfo()" class="w-full text-right px-4 py-3 rounded-lg hover:bg-gray-100 flex items-center">
                    ğŸ‘¤ Ù…Ø´Ø®ØµØ§Øª Ú©Ø§Ø±Ø¨Ø±
                </button>
                <button onclick="showPerformance()" class="w-full text-right px-4 py-3 rounded-lg hover:bg-gray-100 flex items-center">
                    ğŸ“Š Ù¾Ø§ÛŒØ´ Ø¹Ù…Ù„Ú©Ø±Ø¯
                </button>
                <button onclick="showBackup()" class="w-full text-right px-4 py-3 rounded-lg hover:bg-gray-100 flex items-center">
                    ğŸ’¾ Ø¨Ú©Ø§Ù¾ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ
                </button>
                <button onclick="showSupport()" class="w-full text-right px-4 py-3 rounded-lg hover:bg-blue-100 text-blue-600 flex items-center">
                    ğŸ“ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ
                </button>
                <button onclick="logout()" class="w-full text-right px-4 py-3 rounded-lg hover:bg-red-100 text-red-600 flex items-center">
                    ğŸšª Ø®Ø±ÙˆØ¬
                </button>
            </div>
        </div>
    </div>

    <!-- ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ -->
    <div id="mainPage" class="hidden">
        <div class="container mx-auto px-4 py-6 max-w-md">
            <!-- Ù‡Ø¯Ø± -->
            <div class="text-center mb-6 bg-white rounded-2xl shadow-lg p-6 border-t-4 border-green-500 relative">
                <!-- Ø¯Ú©Ù…Ù‡ Ù…Ù†Ùˆ -->
                <button onclick="openSidebar()" class="absolute top-4 right-4 p-2 rounded-lg hover:bg-gray-100">
                    <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
                

            <h1 class="text-3xl font-black text-transparent bg-clip-text bg-gradient-to-r from-green-700 to-green-900 mb-3 tracking-wide drop-shadow-lg">Ø«Ø¨Øª Ú¯Ø²Ø§Ø±Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡ Ú©Ø´Øª Ù†ÛŒØ´Ú©Ø±</h1>
            <p class="text-gray-600 text-sm font-medium">ÙˆØ§Ø­Ø¯ Ù†ÛŒØ´Ú©Ø± Ø§Ù…Ø§Ù… Ø®Ù…ÛŒÙ†ÛŒ (Ø±Ù‡)</p>
            <div class="mt-3 flex items-center justify-between">
                <div class="text-xs text-gray-500">Ø³Ø§Ù…Ø§Ù†Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ</div>
                <div id="cloudStatus" class="text-xs px-2 py-1 rounded-full bg-green-100 text-green-600">
                    â˜ï¸ Ø¢Ù†Ù„Ø§ÛŒÙ†
                </div>
            </div>
        </div>

        <!-- ÙØ±Ù… -->
        <div class="form-container rounded-2xl p-6 shadow-lg mb-6">
            <form id="dailyReportForm" class="space-y-4">
                <!-- Ø§Ø¯Ø§Ø±Ù‡ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ¢ Ø§Ø¯Ø§Ø±Ù‡</label>
                    <select id="office" class="input-field w-full px-4 py-3 rounded-lg persian-input" required>
                        <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                        <option value="Ø§ÙˆÙ„">Ø§ÙˆÙ„</option>
                        <option value="Ø¯ÙˆÙ…">Ø¯ÙˆÙ…</option>
                        <option value="Ø³ÙˆÙ…">Ø³ÙˆÙ…</option>
                        <option value="Ú†Ù‡Ø§Ø±Ù…">Ú†Ù‡Ø§Ø±Ù…</option>
                    </select>
                </div>

                <!-- Ù†ÙˆØ¹ Ú©Ø´Øª -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸŒ± Ù†ÙˆØ¹ Ú©Ø´Øª</label>
                    <select id="cultivationType" class="input-field w-full px-4 py-3 rounded-lg persian-input" required onchange="toggleContractorName()">
                        <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                        <option value="Ù¾Ù„Ù†ØªØ±ÛŒ">Ù¾Ù„Ù†ØªØ±ÛŒ</option>
                        <option value="Ø¯Ø³ØªÛŒ">Ø¯Ø³ØªÛŒ</option>
                    </select>
                </div>

                <!-- Ù†Ø§Ù… Ù¾ÛŒÙ…Ø§Ù†Ú©Ø§Ø± Ú©Ø´Øª -->
                <div id="contractorNameContainer" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ‘· Ù†Ø§Ù… Ù¾ÛŒÙ…Ø§Ù†Ú©Ø§Ø± Ú©Ø´Øª</label>
                    <input type="text" id="contractorName" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="Ù†Ø§Ù… Ù¾ÛŒÙ…Ø§Ù†Ú©Ø§Ø± Ú©Ø´Øª Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                </div>

                <!-- Ù†ÙˆØ¹ ÙˆØ§Ø±ÛŒØªÙ‡ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ§¬ Ù†ÙˆØ¹ ÙˆØ§Ø±ÛŒØªÙ‡</label>
                    <select id="varietyType" class="input-field w-full px-4 py-3 rounded-lg persian-input" required onchange="toggleVarietyType()">
                        <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                        <option value="CP69-1062">CP69-1062</option>
                        <option value="CP57-614">CP57-614</option>
                        <option value="CP73-21">CP73-21</option>
                        <option value="CP48-103">CP48-103</option>
                        <option value="IRC-00-14">IRC-00-14</option>
                        <option value="IRC-99-07">IRC-99-07</option>
                        <option value="Ø¯ÛŒÚ¯Ø±">Ø¯ÛŒÚ¯Ø±</option>
                    </select>
                </div>

                <!-- Ù†Ø§Ù… ÙˆØ§Ø±ÛŒØªÙ‡ Ø¯ÛŒÚ¯Ø± -->
                <div id="otherVarietyContainer" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ Ù†Ø§Ù… ÙˆØ§Ø±ÛŒØªÙ‡</label>
                    <input type="text" id="otherVarietyName" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="Ù†Ø§Ù… ÙˆØ§Ø±ÛŒØªÙ‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                </div>



                <!-- Ù†Ø§Ù… Ú©Ø§Ù†Ø§Ù„ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸš° Ù†Ø§Ù… Ú©Ø§Ù†Ø§Ù„</label>
                    <input type="text" id="canalName" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="Ù†Ø§Ù… Ú©Ø§Ù†Ø§Ù„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" required>
                </div>

                <!-- Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ø²Ø±Ø¹Ù‡ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ø²Ø±Ø¹Ù‡</label>
                    <input type="text" id="farmLocation" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ø²Ø±Ø¹Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" required>
                </div>

                <!-- Ø³Ø§Ø¹Øª Ø´Ø±ÙˆØ¹ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ• Ø³Ø§Ø¹Øª Ø´Ø±ÙˆØ¹ Ø¹Ù…Ù„ÛŒØ§Øª</label>
                    <input type="time" id="startTime" class="input-field w-full px-4 py-3 rounded-lg" required>
                </div>

                <!-- Ø³Ø§Ø¹Øª Ù¾Ø§ÛŒØ§Ù† -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ•• Ø³Ø§Ø¹Øª Ù¾Ø§ÛŒØ§Ù† Ø¹Ù…Ù„ÛŒØ§Øª</label>
                    <input type="time" id="endTime" class="input-field w-full px-4 py-3 rounded-lg" required>
                </div>

                <!-- Ù‡Ú©ØªØ§Ø± Ø§Ù…Ø±ÙˆØ² -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ Ù‡Ú©ØªØ§Ø± Ú©Ø´Øª Ø´Ø¯Ù‡ Ø§Ù…Ø±ÙˆØ²</label>
                    <input type="number" id="todayHectares" step="0.1" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="0.0" required>
                </div>

                <!-- Ù‡Ú©ØªØ§Ø± ØªØ§ Ø§Ù…Ø±ÙˆØ² -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“Š Ù‡Ú©ØªØ§Ø± Ú©Ø´Øª Ø´Ø¯Ù‡ ØªØ§ Ø§Ù…Ø±ÙˆØ²</label>
                    <input type="number" id="totalHectares" step="0.1" class="input-field w-full px-4 py-3 rounded-lg persian-input bg-gray-100" readonly>
                </div>

                <!-- Ø³Ø§Ø¹Øª Ø«Ø¨Øª -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">â„1ï¿½7 Ø³Ø§Ø¹Øª Ø«Ø¨Øª Ú¯Ø²Ø§Ø±Ø´</label>
                    <input type="text" id="recordTime" class="input-field w-full px-4 py-3 rounded-lg bg-gray-100" readonly>
                </div>

                <!-- ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“… ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª Ú¯Ø²Ø§Ø±Ø´</label>
                    <input type="text" id="recordDate" class="input-field w-full px-4 py-3 rounded-lg bg-gray-100 persian-input" readonly>
                </div>

                <!-- Ø¨Ø®Ø´ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ØªÙˆÙ‚Ù -->
                <div class="bg-red-50 border-2 border-red-200 rounded-xl p-4 space-y-4">
                    <h3 class="text-lg font-bold text-red-700 mb-4">âš™ï¸ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ØªÙˆÙ‚Ù</h3>
                    
                    <!-- Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÚ¯Ø§Ù‡ -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ”§ Ø§Ù†ØªØ®Ø§Ø¨ Ø¯Ø³ØªÚ¯Ø§Ù‡</label>
                        <select id="stoppedMachine" class="input-field w-full px-4 py-3 rounded-lg persian-input" onchange="toggleStoppedMachineDetails()">
                            <option value="Ù†Ø¯Ø§Ø±Ø¯">Ù†Ø¯Ø§Ø±Ø¯</option>
                            <option value="Ù¾Ù„Ù†ØªØ± ÛŒÚ© Ø±Ø¯ÛŒÙÙ‡ Ø´Ù…Ø§Ø±Ù‡ 1">Ù¾Ù„Ù†ØªØ± ÛŒÚ© Ø±Ø¯ÛŒÙÙ‡ Ø´Ù…Ø§Ø±Ù‡ 1</option>
                            <option value="Ù¾Ù„Ù†ØªØ± ÛŒÚ© Ø±Ø¯ÛŒÙÙ‡ Ø´Ù…Ø§Ø±Ù‡ 2">Ù¾Ù„Ù†ØªØ± ÛŒÚ© Ø±Ø¯ÛŒÙÙ‡ Ø´Ù…Ø§Ø±Ù‡ 2</option>
                            <option value="Ù¾Ù„Ù†ØªØ± 2 Ø±Ø¯ÛŒÙÙ‡ Ø´Ù…Ø§Ø±Ù‡ 1">Ù¾Ù„Ù†ØªØ± 2 Ø±Ø¯ÛŒÙÙ‡ Ø´Ù…Ø§Ø±Ù‡ 1</option>
                            <option value="Ø¯ÛŒÚ¯Ø±">Ø¯ÛŒÚ¯Ø±</option>
                        </select>
                    </div>

                    <!-- Ø¬Ø²Ø¦ÛŒØ§Øª Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ØªÙˆÙ‚Ù -->
                    <div id="stoppedMachineDetails" class="hidden space-y-4">
                        <!-- Ù†Ø§Ù… Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø¯ÛŒÚ¯Ø± -->
                        <div id="otherMachineContainer" class="hidden">
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ Ù†Ø§Ù… Ø¯Ø³ØªÚ¯Ø§Ù‡</label>
                            <input type="text" id="otherMachineName" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="Ù†Ø§Ù… Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯">
                        </div>
                        
                        <!-- Ø³Ø§Ø¹Øª Ø´Ø±ÙˆØ¹ ØªÙˆÙ‚Ù -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ• Ø³Ø§Ø¹Øª Ø´Ø±ÙˆØ¹ ØªÙˆÙ‚Ù</label>
                            <input type="time" id="stopStartTime" class="input-field w-full px-4 py-3 rounded-lg">
                        </div>
                        
                        <!-- Ø³Ø§Ø¹Øª Ù¾Ø§ÛŒØ§Ù† ØªÙˆÙ‚Ù -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ•• Ø³Ø§Ø¹Øª Ù¾Ø§ÛŒØ§Ù† ØªÙˆÙ‚Ù</label>
                            <input type="time" id="stopEndTime" class="input-field w-full px-4 py-3 rounded-lg">
                        </div>
                        
                        <!-- Ø¯Ù„ÛŒÙ„ ØªÙˆÙ‚Ù -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">â„1ï¿½7 Ø¯Ù„ÛŒÙ„ ØªÙˆÙ‚Ù</label>
                            <select id="stopReasonSelect" class="input-field w-full px-4 py-3 rounded-lg persian-input mb-3" onchange="toggleCustomStopReason()">
                                <option value="">Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                                <option value="Ø®Ø±Ø§Ø¨ÛŒ ÙÙ†ÛŒ">Ø®Ø±Ø§Ø¨ÛŒ ÙÙ†ÛŒ</option>
                                <option value="Ù†Ù‚Øµ Ù‚Ø·Ø¹Ø§Øª">Ù†Ù‚Øµ Ù‚Ø·Ø¹Ø§Øª</option>
                                <option value="ØªØ¹Ù…ÛŒØ± Ùˆ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ">ØªØ¹Ù…ÛŒØ± Ùˆ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ</option>
                                <option value="Ú©Ù…Ø¨ÙˆØ¯ Ø³ÙˆØ®Øª">Ú©Ù…Ø¨ÙˆØ¯ Ø³ÙˆØ®Øª</option>
                                <option value="Ø´Ø±Ø§ÛŒØ· Ø¢Ø¨ Ùˆ Ù‡ÙˆØ§ÛŒÛŒ">Ø´Ø±Ø§ÛŒØ· Ø¢Ø¨ Ùˆ Ù‡ÙˆØ§ÛŒÛŒ</option>
                                <option value="Ø¯ÛŒÚ¯Ø±">Ø¯ÛŒÚ¯Ø±</option>
                            </select>
                            
                            <!-- ÙÛŒÙ„Ø¯ Ø¯Ù„ÛŒÙ„ ØªÙˆÙ‚Ù Ø¯ÛŒÚ¯Ø± -->
                            <div id="customStopReasonContainer" class="hidden">
                                <textarea id="customStopReason" rows="2" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="Ø¯Ù„ÛŒÙ„ ØªÙˆÙ‚Ù Ø±Ø§ Ø´Ø±Ø­ Ø¯Ù‡ÛŒØ¯..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Ù†Ú©ØªÙ‡ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“ Ù†Ú©ØªÙ‡</label>
                    <textarea id="notes" rows="3" class="input-field w-full px-4 py-3 rounded-lg persian-input" placeholder="Ù†Ú©Ø§Øª Ø§Ø¶Ø§ÙÛŒ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..."></textarea>
                </div>
            </form>
        </div>

        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 Ø¹Ù…Ù„ÛŒØ§Øª -->
        <div class="space-y-3">
            <button onclick="saveReport()" class="btn-primary w-full py-4 text-white font-medium rounded-xl shadow-lg">
                ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ Ú¯Ø²Ø§Ø±Ø´
            </button>
            
            <div class="grid grid-cols-2 gap-3">
                <button onclick="loadReports()" class="py-3 bg-gray-600 hover:bg-gray-700 text-white font-medium rounded-xl shadow-lg transition-all text-sm">
                    ğŸ“‚ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø„1ï¿½7
                </button>
                <button onclick="syncFromCloud()" class="py-3 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-xl shadow-lg transition-all text-sm">
                    â˜ï¸ Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ø§Ø¨Ø±ÛŒ
                </button>
            </div>
        </div>

        <!-- Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ -->
        <div id="savedReports" class="mt-6 hidden">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡</h3>
            <div id="reportsList" class="space-y-3"></div>
        </div>
        </div>
    </div>

    <!-- ØµÙØ­Ø§Øª Ù…Ù†Ùˆ -->
    <div id="menuPages" class="hidden">
        <!-- Ù…Ø´Ø®ØµØ§Øª Ú©Ø§Ø±Ø¨Ø± -->
        <div id="userInfoPage" class="hidden container mx-auto px-4 py-6 max-w-md">
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800">Ù…Ø´Ø®ØµØ§Øª Ú©Ø§Ø±Ø¨Ø±</h2>
                    <button onclick="backToMain()" class="text-gray-500 hover:text-gray-700">â†„1ï¿½7 Ø¨Ø§Ø²Ú¯Ø´Øª</button>
                </div>
                <div id="userInfoContent" class="space-y-4"></div>
            </div>
        </div>

        <!-- Ù¾Ø§ÛŒØ´ Ø¹Ù…Ù„Ú©Ø±Ø¯ -->
        <div id="performancePage" class="hidden container mx-auto px-4 py-6 max-w-md">
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800">Ù¾Ø§ÛŒØ´ Ø¹Ù…Ù„Ú©Ø±Ø¯</h2>
                    <button onclick="backToMain()" class="text-gray-500 hover:text-gray-700">â†„1ï¿½7 Ø¨Ø§Ø²Ú¯Ø´Øª</button>
                </div>
                <div id="performanceContent" class="space-y-6">
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4 text-center">ğŸ“Š Ø±ÙˆÙ†Ø¯ Ú©Ø´Øª Ù‡Ú©ØªØ§Ø±</h3>
                        <div style="height: 250px;">
                            <canvas id="hectareChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4 text-center">â„1ï¿½7 Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø± Ø±ÙˆØ²Ø§Ù†Ù‡</h3>
                        <div style="height: 250px;">
                            <canvas id="hoursChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ -->
        <div id="supportPage" class="hidden container mx-auto px-4 py-6 max-w-md">
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ÙÙ†ÛŒ</h2>
                    <button onclick="backToMain()" class="text-gray-500 hover:text-gray-700">â†„1ï¿½7 Ø¨Ø§Ø²Ú¯Ø´Øª</button>
                </div>
                
                <div class="space-y-6">
                    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù¾Ø´ØªÛŒØ¨Ø§Ù† -->
                    <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200">
                        <div class="flex items-center mb-4">
                            <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-700 rounded-full flex items-center justify-center text-white text-xl font-bold shadow-lg ml-4">
                                MK
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-blue-800">Ù…Ø­Ù…Ø¯ Ú©Ø¹Ø¨</h3>
                                <p class="text-blue-600 text-sm">Ù…Ø³Ø¦ÙˆÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ÙÙ†ÛŒ</p>
                            </div>
                        </div>
                        
                        <div class="space-y-3">
                            <div class="bg-white p-4 rounded-lg shadow-sm">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <span class="text-2xl ml-3">ğŸ“±</span>
                                        <div>
                                            <div class="font-semibold text-gray-800">Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³</div>
                                            <div class="text-blue-600 font-bold text-lg">09168231334</div>
                                        </div>
                                    </div>
                                    <button onclick="callSupport()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition-all">
                                        ğŸ“ ØªÙ…Ø§Ø³
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø±ÛŒ -->
                    <div class="bg-gradient-to-r from-green-50 to-green-100 p-6 rounded-xl border border-green-200">
                        <h4 class="font-bold text-green-800 mb-3 flex items-center">
                            ğŸ• Ø³Ø§Ø¹Ø§Øª Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ
                        </h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-700">Ø´Ù†Ø¨Ù‡ ØªØ§ Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡:</span>
                                <span class="font-medium text-green-700">8:00 - 16:00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-700">Ù¾Ù†Ø¬â€ŒØ´Ù†Ø¨Ù„1ï¿½7:</span>
                                <span class="font-medium text-green-700">8:00 - 13:00</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-700">Ø¬Ù…Ø¹Ù‡:</span>
                                <span class="font-medium text-red-600">ØªØ¹Ø·ÛŒÙ„</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø³Ø±ÛŒØ¹ -->
                    <div class="bg-gradient-to-r from-yellow-50 to-yellow-100 p-6 rounded-xl border border-yellow-200">
                        <h4 class="font-bold text-yellow-800 mb-3">ğŸ’¡ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø³Ø±ÛŒØ¹</h4>
                        <div class="space-y-2 text-sm text-yellow-700">
                            <p>â€„1ï¿½7 Ø¨Ø±Ø§ÛŒ Ù…Ø´Ú©Ù„Ø§Øª ÙÙ†ÛŒ Ø¨Ø§ Ø´Ù…Ø§Ø±Ù‡ Ø¨Ø§Ù„Ø§ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯</p>
                            <p>â€„1ï¿½7 Ù‚Ø¨Ù„ Ø§Ø² ØªÙ…Ø§Ø³ØŒ Ù†ÙˆØ¹ Ø®Ø·Ø§ Ùˆ Ù¾ÛŒØ§Ù… Ø¢Ù† Ø±Ø§ ÛŒØ§Ø¯Ø¯Ø§Ø´Øª Ú©Ù†ÛŒØ¯</p>
                            <p>â€„1ï¿½7 Ø¨Ø±Ø§ÛŒ Ø¨Ú©Ø§Ù¾ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø² Ù…Ù†ÙˆÛŒ "Ø¨Ú©Ø§Ù¾ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</p>
                            <p>â€„1ï¿½7 Ø¯Ø± ØµÙˆØ±Øª Ù‚Ø·Ø¹ Ø§ÛŒÙ†ØªØ±Ù†ØªØŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ø­Ù„ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ„1ï¿½7</p>
                        </div>
                    </div>
                    

                </div>
            </div>
        </div>

        <!-- Ø¨Ú©Ø§Ù¾ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ -->
        <div id="backupPage" class="hidden container mx-auto px-4 py-6 max-w-md">
            <div class="bg-white rounded-2xl shadow-lg p-6">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-xl font-bold text-gray-800">Ø¨Ú©Ø§Ù¾ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ</h2>
                    <button onclick="backToMain()" class="text-gray-500 hover:text-gray-700">â†„1ï¿½7 Ø¨Ø§Ø²Ú¯Ø´Øª</button>
                </div>
                
                <div class="space-y-6">
                    <!-- Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ú©Ø§Ù¾ -->
                    <div class="bg-gradient-to-r from-green-50 to-green-100 p-6 rounded-xl border border-green-200">
                        <h3 class="text-lg font-semibold text-green-800 mb-3 flex items-center">
                            ğŸ’¾ Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ú©Ø§Ù¾
                        </h3>
                        <p class="text-sm text-green-700 mb-4">
                            ØªÙ…Ø§Ù… Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø„1ï¿½7 Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø´Ù…Ø§ Ø¯Ø± ÛŒÚ© ÙØ§ÛŒÙ„ Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ„1ï¿½7
                        </p>
                        <button onclick="createBackup()" class="btn-primary w-full py-3 text-white font-medium rounded-lg shadow-lg">
                            ğŸ“¥ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ø¨Ú©Ø§Ù¾
                        </button>
                    </div>
                    
                    <!-- Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø¨Ú©Ø§Ù¾ -->
                    <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200">
                        <h3 class="text-lg font-semibold text-blue-800 mb-3 flex items-center">
                            ğŸ“‚ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
                        </h3>
                        <p class="text-sm text-blue-700 mb-4">
                            ÙØ§ÛŒÙ„ Ø¨Ú©Ø§Ù¾ Ù‚Ø¨Ù„ÛŒ Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ ØªØ§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´ÙˆØ¯
                        </p>
                        <div class="space-y-3">
                            <input type="file" id="backupFile" accept=".json" class="input-field w-full px-4 py-3 rounded-lg border-2 border-dashed border-blue-300 bg-white">
                            <button onclick="restoreBackup()" class="btn-secondary w-full py-3 text-white font-medium rounded-lg shadow-lg">
                                ğŸ”„ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø§Ø² ÙØ§ÛŒÙ„
                            </button>
                        </div>
                    </div>
                    
                    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ¹Ù„ÛŒ -->
                    <div class="bg-gradient-to-r from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200">
                        <h3 class="text-lg font-semibold text-purple-800 mb-3">ğŸ“Š Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ¹Ù„ÛŒ</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white p-3 rounded-lg text-center">
                                <div class="text-xl font-bold text-purple-600" id="currentReportsCount">0</div>
                                <div class="text-xs text-gray-600">Ú¯Ø²Ø§Ø±Ø´ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡</div>
                            </div>
                            <div class="bg-white p-3 rounded-lg text-center">
                                <div class="text-xl font-bold text-green-600" id="currentTotalHectares">0.0</div>
                                <div class="text-xs text-gray-600">Ú©Ù„ Ù‡Ú©ØªØ§Ø±</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ù‡Ø´Ø¯Ø§Ø± -->
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div class="flex items-start">
                            <div class="text-yellow-600 text-xl ml-3">âš ï¸</div>
                            <div>
                                <h4 class="text-sm font-semibold text-yellow-800">Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…</h4>
                                <p class="text-xs text-yellow-700 mt-1">
                                    Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§ØªØŒ ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 ÙØ¹Ù„ÛŒ Ø±Ø§ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ù…ÛŒâ€ŒÚ©Ù†Ø„1ï¿½7. Ø­ØªÙ…Ø§Ù‹ Ù‚Ø¨Ù„ Ø§Ø² Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒØŒ Ø¨Ú©Ø§Ù¾ Ø¬Ø¯ÛŒØ¯ ØªÙ‡ÛŒÙ‡ Ú©Ù†ÛŒØ¯.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ØªØ¨Ø¯ÛŒÙ„ ØªØ§Ø±ÛŒØ® Ù…ÛŒÙ„Ø§Ø¯ÛŒ Ø¨Ù‡ Ø´Ù…Ø³ÛŒ
        function toPersianDate(date) {
            const persianMonths = [
                'ÙØ±ÙˆØ±Ø¯ÛŒÙ†', 'Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', 'Ø®Ø±Ø¯Ø§Ø¯', 'ØªÛŒØ±', 'Ù…Ø±Ø¯Ø§Ø¯', 'Ø´Ù‡Ø±ÛŒÙˆØ±',
                'Ù…Ù‡Ø±', 'Ø¢Ø¨Ø§Ù†', 'Ø¢Ø°Ø±', 'Ø¯ÛŒ', 'Ø¨Ù‡Ù…Ù†', 'Ø§Ø³ÙÙ†Ø¯'
            ];
            
            // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ Intl Ø¨Ø±Ø§ÛŒ ØªØ¨Ø¯ÛŒÙ„ Ø¯Ù‚ÛŒÙ‚
            try {
                const persianDate = new Intl.DateTimeFormat('fa-IR-u-ca-persian', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                }).format(date);
                return persianDate;
            } catch (error) {
                // Ø±ÙˆØ´ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ
                const gy = date.getFullYear();
                const gm = date.getMonth() + 1;
                const gd = date.getDate();
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø§Ø¯Ù‡ ØªØ± Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´
                let jy = gy - 621;
                let jm = gm;
                let jd = gd;
                
                // ØªÙ†Ø¸ÛŒÙ… ØªÙ‚Ø±ÛŒØ¨ÛŒ Ù…Ø§Ù‡â€ŒÙ‡Ø„1ï¿½7
                if (gm <= 3) {
                    jy--;
                    jm += 9;
                } else {
                    jm -= 3;
                }
                
                // Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† Ù…Ø§Ù‡ Ø¨Ù‡ 12
                if (jm > 12) jm = 12;
                if (jm < 1) jm = 1;
                
                return `${jd} ${persianMonths[jm - 1]} ${jy}`;
            }
        }

        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²Û„1ï¿½7 ÙØ±Ù…
        function initializeForm() {
            const now = new Date();
            document.getElementById('recordTime').value = now.toLocaleTimeString('fa-IR', {hour: '2-digit', minute: '2-digit'});
            document.getElementById('recordDate').value = toPersianDate(now);
            
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©Ù„ Ù‡Ú©ØªØ§Ø±
            calculateTotalHectares();
        }

        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ú©Ù„ Ù‡Ú©ØªØ§Ø± Ø§Ø² Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ù‚Ø¨Ù„ÛŒ
        function calculateTotalHectares() {
            const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
            const total = reports.reduce((sum, report) => sum + parseFloat(report.todayHectares || 0), 0);
            const todayHectares = parseFloat(document.getElementById('todayHectares').value || 0);
            document.getElementById('totalHectares').value = (total + todayHectares).toFixed(1);
        }

        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†Û„1ï¿½7 Ú©Ù„ Ù‡Ú©ØªØ§Ø± Ù‡Ù†Ú¯Ø§Ù… ØªØºÛŒÛŒØ± Ù‡Ú©ØªØ§Ø± Ø§Ù…Ø±ÙˆØ²
        document.getElementById('todayHectares').addEventListener('input', calculateTotalHectares);

        // Ú©Ù†ØªØ±Ù„ Ù†Ù…Ø§ÛŒØ´ ÙÛŒÙ„Ø¯ ÙˆØ§Ø±ÛŒØªÙ‡ Ø¯ÛŒÚ¯Ø±
        function toggleVarietyType() {
            const varietyType = document.getElementById('varietyType').value;
            const otherContainer = document.getElementById('otherVarietyContainer');
            
            if (varietyType === 'Ø¯ÛŒÚ¯Ø±') {
                otherContainer.classList.remove('hidden');
            } else {
                otherContainer.classList.add('hidden');
            }
        }

        // Ú©Ù†ØªØ±Ù„ Ù†Ù…Ø§ÛŒØ´ ÙÛŒÙ„Ø¯ Ù†Ø§Ù… Ù¾ÛŒÙ…Ø§Ù†Ú©Ø§Ø±
        function toggleContractorName() {
            const cultivationType = document.getElementById('cultivationType').value;
            const contractorContainer = document.getElementById('contractorNameContainer');
            
            if (cultivationType === 'Ø¯Ø³ØªÛŒ') {
                contractorContainer.classList.remove('hidden');
            } else {
                contractorContainer.classList.add('hidden');
            }
        }

        // Ú©Ù†ØªØ±Ù„ Ù†Ù…Ø§ÛŒØ´ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ØªÙˆÙ‚Ù
        function toggleStoppedMachineDetails() {
            const stoppedMachine = document.getElementById('stoppedMachine').value;
            const detailsContainer = document.getElementById('stoppedMachineDetails');
            const otherContainer = document.getElementById('otherMachineContainer');
            
            if (stoppedMachine === 'Ù†Ø¯Ø§Ø±Ø¯') {
                detailsContainer.classList.add('hidden');
            } else {
                detailsContainer.classList.remove('hidden');
                
                if (stoppedMachine === 'Ø¯ÛŒÚ¯Ø±') {
                    otherContainer.classList.remove('hidden');
                } else {
                    otherContainer.classList.add('hidden');
                }
            }
        }

        // Ú©Ù†ØªØ±Ù„ Ù†Ù…Ø§ÛŒØ´ ÙÛŒÙ„Ø¯ Ø¯Ù„ÛŒÙ„ ØªÙˆÙ‚Ù Ø¯ÛŒÚ¯Ø±
        function toggleCustomStopReason() {
            const stopReasonSelect = document.getElementById('stopReasonSelect').value;
            const customContainer = document.getElementById('customStopReasonContainer');
            
            if (stopReasonSelect === 'Ø¯ÛŒÚ¯Ø±') {
                customContainer.classList.remove('hidden');
            } else {
                customContainer.classList.add('hidden');
            }
        }

        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ
        const CLOUD_CONFIG = {
            // Ø°Ø®ÛŒØ±Ù‡ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø„1ï¿½7
            reportsBinId: '68a61658d0ea881f405e7e4e',
            // Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Ø¨Ø±Ø§Ù†
            usersBinId: '68a9fe84ae596e708fd25e33',
            masterKey: '$2a$10$ndv0U7pxAuajXToOkZYy8OCvhOuDIGuJVsCxbt2FlvUJKondHM/LW',
            baseUrl: 'https://api.jsonbin.io/v3/b'
        };

        // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ
        async function saveToCloud(data, binId) {
            try {
                const response = await fetch(`${CLOUD_CONFIG.baseUrl}/${binId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': CLOUD_CONFIG.masterKey,
                        'X-Bin-Versioning': 'false'
                    },
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                return { success: true, data: result };
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¨Ø±ÛŒ:', error);
                return { success: false, error: error.message };
            }
        }

        // Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ Ø§Ø² Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ
        async function loadFromCloud(binId) {
            try {
                const response = await fetch(`${CLOUD_CONFIG.baseUrl}/${binId}/latest`, {
                    method: 'GET',
                    headers: {
                        'X-Master-Key': CLOUD_CONFIG.masterKey
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                return { success: true, data: result.record };
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ Ø§Ø¨Ø±ÛŒ:', error);
                return { success: false, error: error.message };
            }
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ø¯Ø± Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ
        async function saveUserToCloud(userData) {
            try {
                // Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 Ú©Ø§Ø±Ø¨Ø±
                if (!userData || !userData.employeeId || !userData.fullName) {
                    console.error('Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ù‚Øµ Ø§Ø³Øª:', userData);
                    return { success: false, error: 'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 Ú©Ø§Ø±Ø¨Ø± Ù†Ø§Ù‚Øµ Ø§Ø³Øª' };
                }

                // Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ Ú©Ø§Ø±Ø¨Ø±Ø§Ù† Ù…ÙˆØ¬ÙˆØ¯
                const existingUsersResult = await loadFromCloud(CLOUD_CONFIG.usersBinId);
                let allUsers = {};
                
                if (existingUsersResult.success && existingUsersResult.data) {
                    // ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† Ù…Ù‚Ø§Ø¯ÛŒØ± null Ùˆ Ù†Ø§Ù…Ø¹ØªØ¨Ø±
                    const validData = existingUsersResult.data;
                    if (typeof validData === 'object' && validData !== null) {
                        Object.keys(validData).forEach(key => {
                            if (validData[key] && typeof validData[key] === 'object' && validData[key].employeeId) {
                                allUsers[key] = validData[key];
                            }
                        });
                    }
                }
                
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ÛŒØ§ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†Û„1ï¿½7 Ú©Ø§Ø±Ø¨Ø±
                const userKey = userData.employeeId;
                allUsers[userKey] = {
                    fullName: userData.fullName,
                    employeeId: userData.employeeId,
                    loginDate: userData.loginDate || new Date().toISOString(),
                    lastLogin: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø³Ø±ÙˆØ±
                const result = await saveToCloud(allUsers, CLOUD_CONFIG.usersBinId);
                return result;
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Ø¨Ø±:', error);
                return { success: false, error: error.message };
            }
        }

        // Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ø§Ø² Ø³Ø±ÙˆØ±
        async function loadUserFromCloud(employeeId) {
            try {
                const usersResult = await loadFromCloud(CLOUD_CONFIG.usersBinId);
                
                if (usersResult.success && usersResult.data && usersResult.data[employeeId]) {
                    return { success: true, user: usersResult.data[employeeId] };
                }
                
                return { success: false, error: 'Ú©Ø§Ø±Ø¨Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯' };
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ Ú©Ø§Ø±Ø¨Ø±:', error);
                return { success: false, error: error.message };
            }
        }

        // Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ
        async function syncUserReportsWithCloud(employeeId) {
            try {
                // Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª Ù¾Ø±Ø³Ù†Ù„ÛŒ
                if (!employeeId || employeeId.trim() === '') {
                    console.error('Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª Ù¾Ø±Ø³Ù†Ù„ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª');
                    return { success: false, error: 'Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª Ù¾Ø±Ø³Ù†Ù„ÛŒ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª' };
                }

                // Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ ØªÙ…Ø§Ù… Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø„1ï¿½7 Ø§Ø² Ø³Ø±ÙˆØ±
                const reportsResult = await loadFromCloud(CLOUD_CONFIG.reportsBinId);
                let allReports = {};
                
                if (reportsResult.success && reportsResult.data) {
                    // ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 Ù…Ø¹ØªØ¨Ø±
                    const validData = reportsResult.data;
                    if (typeof validData === 'object' && validData !== null) {
                        Object.keys(validData).forEach(key => {
                            if (validData[key] && Array.isArray(validData[key])) {
                                // ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ù…Ø¹ØªØ¨Ø±
                                const validReports = validData[key].filter(report => 
                                    report && 
                                    typeof report === 'object' && 
                                    report.id && 
                                    report.office &&
                                    report.todayHectares !== undefined
                                );
                                if (validReports.length > 0) {
                                    allReports[key] = validReports;
                                }
                            }
                        });
                    }
                }
                
                // Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ù…Ø­Ù„ÛŒ Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ù„ÛŒ
                const localReports = JSON.parse(localStorage.getItem('farmReports') || '[]');
                const validLocalReports = localReports.filter(report => 
                    report && 
                    typeof report === 'object' && 
                    report.id && 
                    report.office &&
                    report.todayHectares !== undefined
                );
                
                // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ù…Ø­Ù„ÛŒ Ø¨Ù‡ Ø³Ø±ÙˆØ±
                if (!allReports[employeeId]) {
                    allReports[employeeId] = [];
                }
                
                // Ø§Ø¯ØºØ§Ù… Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø„1ï¿½7 (Ø­Ø°Ù ØªÚ©Ø±Ø§Ø±ÛŒâ€ŒÙ‡Ø„1ï¿½7)
                const existingIds = allReports[employeeId].map(r => r.id);
                const newReports = validLocalReports.filter(r => !existingIds.includes(r.id));
                
                if (newReports.length > 0) {
                    allReports[employeeId] = [...allReports[employeeId], ...newReports];
                }
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø³Ø±ÙˆØ±
                const saveResult = await saveToCloud(allReports, CLOUD_CONFIG.reportsBinId);
                
                if (saveResult.success) {
                    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†Û„1ï¿½7 Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ù…Ø­Ù„ÛŒ Ø¨Ø§ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ø³Ø±ÙˆØ±
                    localStorage.setItem('farmReports', JSON.stringify(allReports[employeeId] || []));
                    return { success: true, newReports: newReports.length };
                }
                
                return saveResult;
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø„1ï¿½7:', error);
                return { success: false, error: error.message };
            }
        }

        // Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ú©Ù„ÛŒ Ø¨Ø§ Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ
        async function syncWithCloud() {
            const localUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
            
            if (!localUser.employeeId) {
                return { success: false, error: 'Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯' };
            }
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±
            const userResult = await saveUserToCloud(localUser);
            
            // Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø„1ï¿½7
            const reportsResult = await syncUserReportsWithCloud(localUser.employeeId);
            
            return {
                success: userResult.success && reportsResult.success,
                userSaved: userResult.success,
                reportsSynced: reportsResult.success,
                newReports: reportsResult.newReports || 0
            };
        }

        // Ø°Ø®ÛŒØ±Ù‡ Ú¯Ø²Ø§Ø±Ø´
        async function saveReport() {
            const form = document.getElementById('dailyReportForm');
            if (!form.checkValidity()) {
                showToast('Ù„Ø·ÙØ§Ù‹ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ø§Ù„Ø²Ø§Ù…ÛŒ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯', 'error');
                return;
            }

            // Ù†Ù…Ø§ÛŒØ´ Ø­Ø§Ù„Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ
            const saveBtn = document.querySelector('button[onclick="saveReport()"]');
            const originalText = saveBtn.innerHTML;
            saveBtn.innerHTML = 'â„1ï¿½7 Ø¯Ø± Ø­Ø§Ù„ Ø°Ø®ÛŒØ±Ù‡...';
            saveBtn.disabled = true;

            const stoppedMachine = document.getElementById('stoppedMachine').value;
            const otherMachineName = document.getElementById('otherMachineName').value;
            const stopReasonSelect = document.getElementById('stopReasonSelect').value;
            const customStopReason = document.getElementById('customStopReason').value;
            const varietyType = document.getElementById('varietyType').value;
            const otherVarietyName = document.getElementById('otherVarietyName').value;
            
            const report = {
                id: Date.now(),
                office: document.getElementById('office').value,
                cultivationType: document.getElementById('cultivationType').value,
                contractorName: document.getElementById('contractorName').value,
                varietyType: varietyType,
                otherVarietyName: varietyType === 'Ø¯ÛŒÚ¯Ø±' ? otherVarietyName : '',
                stoppedMachine: stoppedMachine,
                otherMachineName: stoppedMachine === 'Ø¯ÛŒÚ¯Ø±' ? otherMachineName : '',
                stopStartTime: document.getElementById('stopStartTime').value,
                stopEndTime: document.getElementById('stopEndTime').value,
                stopReason: stopReasonSelect === 'Ø¯ÛŒÚ¯Ø±' ? customStopReason : stopReasonSelect,
                canalName: document.getElementById('canalName').value,
                farmLocation: document.getElementById('farmLocation').value,
                startTime: document.getElementById('startTime').value,
                endTime: document.getElementById('endTime').value,
                todayHectares: document.getElementById('todayHectares').value,
                totalHectares: document.getElementById('totalHectares').value,
                recordTime: document.getElementById('recordTime').value,
                recordDate: document.getElementById('recordDate').value,
                notes: document.getElementById('notes').value,
                timestamp: new Date().toISOString()
            };

            // Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­Ù„ÛŒ
            const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
            reports.push(report);
            localStorage.setItem('farmReports', JSON.stringify(reports));

            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ
            const cloudResult = await syncWithCloud();
            
            // Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†ÛŒ Ø¯Ú©Ù…Ù‡
            saveBtn.innerHTML = originalText;
            saveBtn.disabled = false;

            if (cloudResult.success) {
                showToast('âœ„1ï¿½7 Ú¯Ø²Ø§Ø±Ø´ Ø¯Ø± Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
            } else {
                showToast('âš ï¸ Ú¯Ø²Ø§Ø±Ø´ Ù…Ø­Ù„ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯ - Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø§Ø¨Ø±ÛŒ', 'error');
            }

            form.reset();
            initializeForm();
        }





        // Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ø§Ø² Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ
        async function syncFromCloud() {
            const syncBtn = document.querySelector('button[onclick="syncFromCloud()"]');
            const originalText = syncBtn.innerHTML;
            syncBtn.innerHTML = 'â„1ï¿½7 Ø¯Ø± Ø­Ø§Ù„ Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7...';
            syncBtn.disabled = true;

            try {
                const localUser = JSON.parse(localStorage.getItem('currentUser') || '{}');
                
                if (!localUser.employeeId) {
                    showToast('â„1ï¿½7 Ø§Ø¨ØªØ¯Ø§ ÙˆØ§Ø±Ø¯ Ø³ÛŒØ³ØªÙ… Ø´ÙˆÛŒØ¯', 'error');
                    return;
                }

                // Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ú©Ø§Ø±Ø¨Ø±
                const result = await syncUserReportsWithCloud(localUser.employeeId);
                
                if (result.success) {
                    calculateTotalHectares();
                    
                    if (result.newReports > 0) {
                        showToast(`âœ„1ï¿½7 ${result.newReports} Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø¯ÛŒØ¯ Ø§Ø² Ø³Ø±ÙˆØ± Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯`);
                    } else {
                        showToast('âœ„1ï¿½7 Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ù‡â€ŒØ±ÙˆØ„1ï¿½7 Ø§Ø³Øª - ØªØºÛŒÛŒØ±ÛŒ Ù†ÛŒØ§ÙØª');
                    }
                } else {
                    showToast('â„1ï¿½7 Ø®Ø·Ø§ Ø¯Ø± Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ø¨Ø§ Ø³Ø±ÙˆØ±', 'error');
                }
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7:', error);
                showToast('â„1ï¿½7 Ø®Ø·Ø§ Ø¯Ø± Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ø¨Ø§ Ø³Ø±ÙˆØ±', 'error');
            } finally {
                syncBtn.innerHTML = originalText;
                syncBtn.disabled = false;
            }
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ùˆ Ù†Ù…Ø§ÛŒØ´ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø„1ï¿½7
        function loadReports() {
            const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
            const container = document.getElementById('savedReports');
            const list = document.getElementById('reportsList');
            
            if (reports.length === 0) {
                showToast('Ù‡ÛŒÚ† Ú¯Ø²Ø§Ø±Ø´ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª', 'error');
                return;
            }

            list.innerHTML = '';
            reports.reverse().forEach(report => {
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø±
                let workHours = 'Ù†Ø§Ù…Ø´Ø®Øµ';
                if (report.startTime && report.endTime) {
                    try {
                        const start = new Date(`2000-01-01 ${report.startTime}`);
                        const end = new Date(`2000-01-01 ${report.endTime}`);
                        let hours = (end - start) / (1000 * 60 * 60);
                        if (hours < 0) hours += 24;
                        workHours = `${Math.round(hours * 10) / 10} Ø³Ø§Ø¹Øª`;
                    } catch (error) {
                        workHours = 'Ù†Ø§Ù…Ø´Ø®Øµ';
                    }
                }
                
                // Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ØªÙˆÙ‚Ù
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const reporterName = user.fullName || 'Ù†Ø§Ù…Ø´Ø®Øµ';
                
                let machineInfo = 'Ù†Ø¯Ø§Ø±Ø¯';
                if (report.stoppedMachine && report.stoppedMachine !== 'Ù†Ø¯Ø§Ø±Ø¯') {
                    const machineName = report.stoppedMachine === 'Ø¯ÛŒÚ¯Ø±' ? report.otherMachineName : report.stoppedMachine;
                    const stopDuration = calculateStopDuration(report.stopStartTime, report.stopEndTime);
                    machineInfo = `${machineName} (${stopDuration})`;
                }
                
                const div = document.createElement('div');
                div.className = 'bg-white p-4 rounded-lg shadow border-r-4 border-green-500';
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <h4 class="font-bold text-gray-800 text-lg">ğŸ‘¤ ${reporterName}</h4>
                        <div class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded">
                            Ø´Ù†Ø§Ø³Ù‡: ${report.id}
                        </div>
                    </div>
                    <div class="space-y-2 text-sm mb-4">
                        <p class="text-gray-700"><span class="font-medium">ğŸ†” Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª:</span> ${user.employeeId || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</p>
                        <p class="text-gray-700"><span class="font-medium">ğŸ¢ Ø§Ø¯Ø§Ø±Ù‡:</span> ${report.office}</p>
                        <p class="text-gray-700"><span class="font-medium">ğŸŒ± Ù†ÙˆØ¹ Ú©Ø´Øª:</span> ${report.cultivationType}</p>
                        ${report.contractorName ? `<p class="text-gray-700"><span class="font-medium">ğŸ‘· Ù¾ÛŒÙ…Ø§Ù†Ú©Ø§Ø±:</span> ${report.contractorName}</p>` : ''}
                        <p class="text-gray-700"><span class="font-medium">ğŸ§¬ ÙˆØ§Ø±ÛŒØªÙ‡:</span> ${report.varietyType === 'Ø¯ÛŒÚ¯Ø±' ? report.otherVarietyName : report.varietyType}</p>
                        <p class="text-gray-700"><span class="font-medium">ğŸš° Ú©Ø§Ù†Ø§Ù„:</span> ${report.canalName}</p>
                        <p class="text-gray-700"><span class="font-medium">ğŸ“ Ù…Ø²Ø±Ø¹Ù‡:</span> ${report.farmLocation}</p>
                        <p class="text-gray-700"><span class="font-medium">â„1ï¿½7 Ø³Ø§Ø¹Øª Ú©Ø§Ø±:</span> ${report.startTime} ØªØ§ ${report.endTime}</p>
                        <p class="text-gray-700"><span class="font-medium">âš™ï¸ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ØªÙˆÙ‚Ù:</span> ${machineInfo}</p>
                        <p class="text-blue-600 font-medium"><span class="font-medium">ğŸ• Ù…Ø¯Øª Ú©Ø§Ø±:</span> ${workHours}</p>
                        <p class="text-green-600 font-medium"><span class="font-medium">ğŸ“ Ù‡Ú©ØªØ§Ø± Ø§Ù…Ø±ÙˆØ²:</span> ${report.todayHectares}</p>
                        <p class="text-green-600 font-medium"><span class="font-medium">ğŸ“Š Ù‡Ú©ØªØ§Ø± ØªØ§ Ø§Ù…Ø±ÙˆØ²:</span> ${report.totalHectares}</p>
                        <p class="text-gray-600 font-medium"><span class="font-medium">ğŸ“… Ø«Ø¨Øª:</span> ${report.recordDate} - ${report.recordTime}</p>
                    </div>
                    <div class="flex gap-2 pt-3 border-t border-gray-200">
                        <button onclick="copyReportText(${report.id})" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-medium transition-all">
                            ğŸ“‹ Ú©Ù¾ÛŒ Ù…ØªÙ†
                        </button>
                        <button onclick="downloadSingleReportExcel(${report.id})" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-2 px-3 rounded-lg text-sm font-medium transition-all">
                            ğŸ“Š Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ú©Ø³Ù„
                        </button>
                    </div>
                    <div class="flex gap-2 pt-2">
                        <button onclick="editReport(${report.id})" class="flex-1 bg-orange-500 hover:bg-orange-600 text-white py-2 px-3 rounded-lg text-sm font-medium transition-all">
                            âœï¸ ÙˆÛŒØ±Ø§ÛŒØ´
                        </button>
                        <button onclick="deleteReport(${report.id})" class="flex-1 bg-red-500 hover:bg-red-600 text-white py-2 px-3 rounded-lg text-sm font-medium transition-all">
                            ğŸ—‘ï¸„1ï¿½7 Ø­Ø°Ù
                        </button>
                    </div>
                `;
                list.appendChild(div);
            });
            
            container.classList.remove('hidden');
        }

        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¯Øª ØªÙˆÙ‚Ù Ø¯Ø³ØªÚ¯Ø§Ù‡
        function calculateStopDuration(startTime, endTime) {
            if (!startTime || !endTime) return 'Ù†Ø§Ù…Ø´Ø®Øµ';
            
            try {
                const start = new Date(`2000-01-01 ${startTime}`);
                const end = new Date(`2000-01-01 ${endTime}`);
                let hours = (end - start) / (1000 * 60 * 60);
                
                if (hours < 0) hours += 24;
                
                const wholeHours = Math.floor(hours);
                const minutes = Math.round((hours - wholeHours) * 60);
                
                if (wholeHours === 0) {
                    return `${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡`;
                } else if (minutes === 0) {
                    return `${wholeHours} Ø³Ø§Ø¹Øª`;
                } else {
                    return `${wholeHours} Ø³Ø§Ø¹Øª Ùˆ ${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡`;
                }
            } catch (error) {
                return 'Ù†Ø§Ù…Ø´Ø®Øµ';
            }
        }



        // Ø­Ø°Ù Ú¯Ø²Ø§Ø±Ø´
        function deleteReport(id) {
            const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
            const report = reports.find(r => r.id === id);
            
            if (!report) {
                showToast('Ú¯Ø²Ø§Ø±Ø´ ÛŒØ§ÙØª Ù†Ø´Ø¯', 'error');
                return;
            }
            
            const confirmMessage = `Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ„1ï¿½7 Ø§ÛŒÙ† Ú¯Ø²Ø§Ø±Ø´ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯ØŸ\n\n` +
                `ğŸ“… ØªØ§Ø±ÛŒØ®: ${report.recordDate}\n` +
                `ğŸ¢ Ø§Ø¯Ø§Ø±Ù‡: ${report.office}\n` +
                `ğŸ“ Ù‡Ú©ØªØ§Ø±: ${report.todayHectares}\n\n` +
                `Ø§ÛŒÙ† Ø¹Ù…Ù„ Ù‚Ø§Ø¨Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª Ù†ÛŒØ³Øª!`;
            
            if (confirm(confirmMessage)) {
                const filtered = reports.filter(r => r.id !== id);
                localStorage.setItem('farmReports', JSON.stringify(filtered));
                loadReports();
                calculateTotalHectares();
                showToast('Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø­Ø°Ù Ø´Ø¯');
            }
        }

        // ÙˆÛŒØ±Ø§ÛŒØ´ Ú¯Ø²Ø§Ø±Ø´
        function editReport(id) {
            const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
            const report = reports.find(r => r.id === id);
            
            if (!report) {
                showToast('Ú¯Ø²Ø§Ø±Ø´ ÛŒØ§ÙØª Ù†Ø´Ø¯', 'error');
                return;
            }
            
            // Ù¾Ø± Ú©Ø±Ø¯Ù† ÙØ±Ù… Ø¨Ø§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú¯Ø²Ø§Ø±Ø´
            document.getElementById('office').value = report.office || '';
            document.getElementById('cultivationType').value = report.cultivationType || '';
            document.getElementById('contractorName').value = report.contractorName || '';
            document.getElementById('varietyType').value = report.varietyType || '';
            document.getElementById('otherVarietyName').value = report.otherVarietyName || '';
            document.getElementById('stoppedMachine').value = report.stoppedMachine || 'Ù†Ø¯Ø§Ø±Ø¯';
            document.getElementById('otherMachineName').value = report.otherMachineName || '';
            document.getElementById('stopStartTime').value = report.stopStartTime || '';
            document.getElementById('stopEndTime').value = report.stopEndTime || '';
            document.getElementById('stopReasonSelect').value = report.stopReason || '';
            document.getElementById('customStopReason').value = report.stopReason || '';
            document.getElementById('canalName').value = report.canalName || '';
            document.getElementById('farmLocation').value = report.farmLocation || '';
            document.getElementById('startTime').value = report.startTime || '';
            document.getElementById('endTime').value = report.endTime || '';
            document.getElementById('todayHectares').value = report.todayHectares || '';
            document.getElementById('notes').value = report.notes || '';
            
            // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯Ù‡Ø§ÛŒ Ù…Ø´Ø±ÙˆØ·
            toggleContractorName();
            toggleVarietyType();
            toggleStoppedMachineDetails();
            toggleCustomStopReason();
            
            // Ø­Ø°Ù Ú¯Ø²Ø§Ø±Ø´ Ù‚Ø¯ÛŒÙ…ÛŒ
            deleteReport(id);
            
            // Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ
            backToMain();
            
            // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù…
            showToast('Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯ - ØªØºÛŒÛŒØ±Ø§Øª Ø±Ø§ Ø§Ø¹Ù…Ø§Ù„ Ú©Ù†ÛŒØ¯ Ùˆ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯');
            
            // Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Ú©Ù¾ÛŒ Ù…ØªÙ† Ú¯Ø²Ø§Ø±Ø´ Ù…Ù†ÙØ±Ø¯
        function copyReportText(id) {
            try {
                const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
                const report = reports.find(r => r.id === id);
                
                if (!report) {
                    showToast('Ú¯Ø²Ø§Ø±Ø´ ÛŒØ§ÙØª Ù†Ø´Ø¯', 'error');
                    return;
                }
                
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                const reporterName = user.fullName || 'Ù†Ø§Ù…Ø´Ø®Øµ';
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø±
                let workHours = 'Ù†Ø§Ù…Ø´Ø®Øµ';
                if (report.startTime && report.endTime) {
                    try {
                        const start = new Date(`2000-01-01 ${report.startTime}`);
                        const end = new Date(`2000-01-01 ${report.endTime}`);
                        let hours = (end - start) / (1000 * 60 * 60);
                        if (hours < 0) hours += 24;
                        workHours = `${Math.round(hours * 10) / 10} Ø³Ø§Ø¹Øª`;
                    } catch (error) {
                        workHours = 'Ù†Ø§Ù…Ø´Ø®Øµ';
                    }
                }
                
                // Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ØªÙˆÙ‚Ù
                let machineInfo = 'Ù†Ø¯Ø§Ø±Ø¯';
                if (report.stoppedMachine && report.stoppedMachine !== 'Ù†Ø¯Ø§Ø±Ø¯') {
                    const machineName = report.stoppedMachine === 'Ø¯ÛŒÚ¯Ø±' ? report.otherMachineName : report.stoppedMachine;
                    const stopDuration = calculateStopDuration(report.stopStartTime, report.stopEndTime);
                    machineInfo = `${machineName} (Ù…Ø¯Øª ØªÙˆÙ‚Ù: ${stopDuration})`;
                    if (report.stopReason) {
                        machineInfo += ` - Ø¯Ù„ÛŒÙ„: ${report.stopReason}`;
                    }
                }
                
                const text = `Ú¯Ø²Ø§Ø±Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡ Ú©Ø´Øª Ù†ÛŒØ´Ú©Ø±
ğŸ‘¤ Ú¯Ø²Ø§Ø±Ø´ Ø¯Ù‡Ù†Ø¯Ù‡: ${reporterName}
ğŸ¢ Ø§Ø¯Ø§Ø±Ù‡: ${report.office}
ğŸŒ± Ù†ÙˆØ¹ Ú©Ø´Øª: ${report.cultivationType}${report.contractorName ? `\nğŸ‘· Ù¾ÛŒÙ…Ø§Ù†Ú©Ø§Ø± Ú©Ø´Øª: ${report.contractorName}` : ''}
ğŸ§¬ Ù†ÙˆØ¹ ÙˆØ§Ø±ÛŒØªÙ‡: ${report.varietyType === 'Ø¯ÛŒÚ¯Ø±' ? report.otherVarietyName : report.varietyType}
ğŸš° Ú©Ø§Ù†Ø§Ù„: ${report.canalName}
ğŸ“ Ù…Ø²Ø±Ø¹Ù‡: ${report.farmLocation}
â„1ï¿½7 Ø³Ø§Ø¹Øª Ø´Ø±ÙˆØ¹/Ù¾Ø§ÛŒØ§Ù†: ${report.startTime} ØªØ§ ${report.endTime}
âš™ï¸ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ØªÙˆÙ‚Ù: ${machineInfo}
ğŸ• ØªØ¹Ø¯Ø§Ø¯ Ø³Ø§Ø¹Øª Ú©Ø§Ø±: ${workHours}
ğŸ“… ØªØ§Ø±ÛŒØ®/Ø³Ø§Ø¹Øª Ø«Ø¨Øª: ${report.recordDate} - ${report.recordTime}
ğŸ“ Ù‡Ú©ØªØ§Ø± Ø§Ù…Ø±ÙˆØ²: ${report.todayHectares}
ğŸ“Š Ù‡Ú©ØªØ§Ø± ØªØ§ Ø§Ù…Ø±ÙˆØ²: ${report.totalHectares}
ğŸ“ Ù†Ú©ØªÙ‡: ${report.notes || 'Ù†Ø¯Ø§Ø±Ø¯'}`;
                
                // Ú©Ù¾ÛŒ Ù…ØªÙ†
                if (navigator.clipboard && window.isSecureContext) {
                    navigator.clipboard.writeText(text).then(() => {
                        showToast('Ù…ØªÙ† Ú¯Ø²Ø§Ø±Ø´ Ú©Ù¾ÛŒ Ø´Ø¯');
                    }).catch((error) => {
                        console.error('Ø®Ø·Ø§ Ø¯Ø± Ú©Ù¾ÛŒ:', error);
                        fallbackCopyTextToClipboard(text);
                    });
                } else {
                    fallbackCopyTextToClipboard(text);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ú©Ù¾ÛŒ Ù…ØªÙ† Ú¯Ø²Ø§Ø±Ø´:', error);
                showToast('Ø®Ø·Ø§ Ø¯Ø± Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù† Ù…ØªÙ†', 'error');
            }
        }

        // Ø±ÙˆØ´ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù¾ÛŒ
        function fallbackCopyTextToClipboard(text) {
            try {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                textArea.style.left = "-999999px";
                textArea.style.top = "-999999px";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                
                const successful = document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (successful) {
                    showToast('Ù…ØªÙ† Ú¯Ø²Ø§Ø±Ø´ Ú©Ù¾ÛŒ Ø´Ø¯');
                } else {
                    showToast('Ø®Ø·Ø§ Ø¯Ø± Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù† Ù…ØªÙ†', 'error');
                }
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø±ÙˆØ´ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ú©Ù¾ÛŒ:', error);
                showToast('Ø®Ø·Ø§ Ø¯Ø± Ú©Ù¾ÛŒ Ú©Ø±Ø¯Ù† Ù…ØªÙ†', 'error');
            }
        }

        // Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø§Ú©Ø³Ù„ Ú¯Ø²Ø§Ø±Ø´ Ù…Ù†ÙØ±Ø¯
        function downloadSingleReportExcel(reportId) {
            const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
            const report = reports.find(r => r.id === reportId);
            
            if (!report) {
                showToast('Ú¯Ø²Ø§Ø±Ø´ ÛŒØ§ÙØª Ù†Ø´Ø¯', 'error');
                return;
            }

            const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
            const reporterName = user.fullName || 'Ù†Ø§Ù…Ø´Ø®Øµ';

            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø±
            let workHours = 'Ù†Ø§Ù…Ø´Ø®Øµ';
            if (report.startTime && report.endTime) {
                try {
                    const start = new Date(`2000-01-01 ${report.startTime}`);
                    const end = new Date(`2000-01-01 ${report.endTime}`);
                    let hours = (end - start) / (1000 * 60 * 60);
                    if (hours < 0) hours += 24;
                    workHours = `${Math.round(hours * 10) / 10} Ø³Ø§Ø¹Øª`;
                } catch (error) {
                    workHours = 'Ù†Ø§Ù…Ø´Ø®Øµ';
                }
            }
            
            const machineName = report.stoppedMachine === 'Ø¯ÛŒÚ¯Ø±' ? report.otherMachineName : report.stoppedMachine;
            const varietyName = report.varietyType === 'Ø¯ÛŒÚ¯Ø±' ? report.otherVarietyName : report.varietyType;
            
            const excelData = [{
                'Ú¯Ø²Ø§Ø±Ø´ Ø¯Ù‡Ù†Ø¯Ù‡': reporterName,
                'Ø´Ù…Ø§Ø±Ù‡ Ú©Ø§Ø±Øª': user.employeeId || 'Ù†Ø§Ù…Ø´Ø®Øµ',
                'Ø§Ø¯Ø§Ø±Ù‡': report.office,
                'Ù†ÙˆØ¹ Ú©Ø´Øª': report.cultivationType,
                'Ù†Ø§Ù… Ù¾ÛŒÙ…Ø§Ù†Ú©Ø§Ø±': report.contractorName || '',
                'Ù†ÙˆØ¹ ÙˆØ§Ø±ÛŒØªÙ‡': varietyName || '',
                'Ù†Ø§Ù… Ú©Ø§Ù†Ø§Ù„': report.canalName,
                'Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ø²Ø±Ø¹Ù‡': report.farmLocation,
                'Ø³Ø§Ø¹Øª Ø´Ø±ÙˆØ¹': report.startTime,
                'Ø³Ø§Ø¹Øª Ù¾Ø§ÛŒØ§Ù†': report.endTime,
                'Ù…Ø¯Øª Ú©Ø§Ø±': workHours,
                'Ø¯Ø³ØªÚ¯Ø§Ù‡ Ù…ØªÙˆÙ‚Ù': report.stoppedMachine || 'Ù†Ø¯Ø§Ø±Ø¯',
                'Ù†Ø§Ù… Ø¯Ø³ØªÚ¯Ø§Ù‡': machineName || '',
                'Ø³Ø§Ø¹Øª Ø´Ø±ÙˆØ¹ ØªÙˆÙ‚Ù': report.stopStartTime || '',
                'Ø³Ø§Ø¹Øª Ù¾Ø§ÛŒØ§Ù† ØªÙˆÙ‚Ù': report.stopEndTime || '',
                'Ø¯Ù„ÛŒÙ„ ØªÙˆÙ‚Ù': report.stopReason || '',
                'Ù‡Ú©ØªØ§Ø± Ø§Ù…Ø±ÙˆØ²': report.todayHectares,
                'Ù‡Ú©ØªØ§Ø± ØªØ§ Ø§Ù…Ø±ÙˆØ²': report.totalHectares,
                'ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª': report.recordDate,
                'Ø³Ø§Ø¹Øª Ø«Ø¨Øª': report.recordTime,
                'Ù†Ú©ØªÙ‡': report.notes || ''
            }];

            const ws = XLSX.utils.json_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Ú¯Ø²Ø§Ø±Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡');
            
            const fileName = `Ú¯Ø²Ø§Ø±Ø´-${report.office}-${report.recordDate}-${reportId}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            showToast('ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ú¯Ø²Ø§Ø±Ø´ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ø´Ø¯');
        }

        // Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ù„Ø§Ù†
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            let bgColor = 'bg-green-500';
            if (type === 'error') bgColor = 'bg-red-500';
            else if (type === 'warning') bgColor = 'bg-orange-500';
            
            toast.className = `toast ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg`;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 4000);
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø­Ø±Ø§Ø² Ù‡ÙˆÛŒØª
        function checkAuth() {
            const user = localStorage.getItem('currentUser');
            if (user) {
                document.getElementById('loginPage').classList.add('hidden');
                document.getElementById('mainPage').classList.remove('hidden');
                initializeForm();
            } else {
                document.getElementById('loginPage').classList.remove('hidden');
                document.getElementById('mainPage').classList.add('hidden');
            }
        }

        // ÙˆØ±ÙˆØ¯ Ú©Ø§Ø±Ø¨Ø±
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const fullName = document.getElementById('fullName').value;
            const employeeId = document.getElementById('employeeId').value;
            const password = document.getElementById('password').value;
            
            if (password !== 'MK1370') {
                showToast('Ø±Ù…Ø² ÙˆØ±ÙˆØ¯ Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª', 'error');
                return;
            }
            
            const userData = {
                fullName: fullName,
                employeeId: employeeId,
                loginDate: new Date().toISOString()
            };
            
            localStorage.setItem('currentUser', JSON.stringify(userData));
            
            // Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø³Ø±ÙˆØ± Ø§Ø¨Ø±ÛŒ
            try {
                await saveUserToCloud(userData);
            } catch (error) {
                console.log('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø³Ø±ÙˆØ±:', error);
            }
            
            showToast('ÙˆØ±ÙˆØ¯ Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ„1ï¿½7 Ø¨ÙˆØ¯');
            checkAuth();
            
            // Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ø®ÙˆØ¯Ú©Ø§Ø± Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§Û„1ï¿½7 Ú©Ø§Ø±Ø¨Ø± Ù¾Ø³ Ø§Ø² ÙˆØ±ÙˆØ¯
            setTimeout(async () => {
                try {
                    const result = await syncUserReportsWithCloud(employeeId);
                    if (result.success && result.newReports > 0) {
                        calculateTotalHectares();
                        showToast(`â˜ï¸ ${result.newReports} Ú¯Ø²Ø§Ø±Ø´ Ø§Ø² Ø³Ø±ÙˆØ± Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯`);
                    }
                } catch (error) {
                    console.log('Ù‡Ù…Ú¯Ø§Ù…â€ŒØ³Ø§Ø²Û„1ï¿½7 Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ù†Ø¬Ø§Ù… Ù†Ø´Ø¯:', error);
                }
            }, 2000);
        });

        // Ø®Ø±ÙˆØ¬ Ú©Ø§Ø±Ø¨Ø±
        function logout() {
            localStorage.removeItem('currentUser');
            closeSidebar();
            checkAuth();
            showToast('Ø®Ø±ÙˆØ¬ Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ„1ï¿½7 Ø¨ÙˆØ¯');
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ù†ÙˆÛŒ Ú©Ù†Ø§Ø±ÛŒ
        function openSidebar() {
            document.getElementById('sidebar').classList.add('open');
            document.getElementById('overlay').classList.add('show');
        }

        function closeSidebar() {
            document.getElementById('sidebar').classList.remove('open');
            document.getElementById('overlay').classList.remove('show');
        }

        // Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ø§Øª Ù…Ù†Ùˆ
        function showUserInfo() {
            const user = JSON.parse(localStorage.getItem('currentUser'));
            if (!user) {
                showToast('Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯', 'error');
                return;
            }
            
            const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
            const totalHectares = reports.reduce((sum, report) => sum + parseFloat(report.todayHectares || 0), 0);
            const content = document.getElementById('userInfoContent');
            
            content.innerHTML = `
                <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-xl border border-green-200">
                    <div class="flex items-center mb-6">
                        <div class="w-20 h-20 bg-gradient-to-br from-green-500 to-green-700 rounded-full flex items-center justify-center text-white text-2xl font-bold shadow-lg">
                            ${user.fullName ? user.fullName.charAt(0) : 'Ú©'}
                        </div>
                        <div class="mr-4">
                            <h3 class="text-xl font-bold text-gray-800">${user.fullName || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</h3>
                            <p class="text-gray-600 font-medium">ğŸ†” Ú©Ø§Ø±Øª Ù¾Ø±Ø³Ù†Ù„ÛŒ: ${user.employeeId || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</p>
                            <p class="text-sm text-green-600 font-medium">âœ„1ï¿½7 Ú©Ø§Ø±Ø¨Ø± ÙØ¹Ø§Ù„</p>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <div class="text-xs text-gray-500 mb-1">ØªØ§Ø±ÛŒØ® ÙˆØ±ÙˆØ¯</div>
                            <div class="text-sm font-medium text-gray-800">
                                ${user.loginDate ? toPersianDate(new Date(user.loginDate)) : 'Ù†Ø§Ù…Ø´Ø®Øµ'}
                            </div>
                        </div>
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <div class="text-xs text-gray-500 mb-1">Ø³Ø§Ø¹Øª ÙˆØ±ÙˆØ¯</div>
                            <div class="text-sm font-medium text-gray-800">
                                ${user.loginDate ? new Date(user.loginDate).toLocaleTimeString('fa-IR', {hour: '2-digit', minute: '2-digit'}) : 'Ù†Ø§Ù…Ø´Ø®Øµ'}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 space-y-4">
                    <div class="bg-blue-50 p-4 rounded-xl border border-blue-200">
                        <h4 class="font-bold text-blue-800 mb-3 flex items-center">
                            ğŸ“Š Ø¢Ù…Ø§Ø± Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø´Ù…Ø§
                        </h4>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white p-3 rounded-lg">
                                <div class="text-2xl font-bold text-blue-600">${reports.length}</div>
                                <div class="text-xs text-gray-600">ØªØ¹Ø¯Ø§Ø¯ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø„1ï¿½7</div>
                            </div>
                            <div class="bg-white p-3 rounded-lg">
                                <div class="text-2xl font-bold text-green-600">${totalHectares.toFixed(1)}</div>
                                <div class="text-xs text-gray-600">Ú©Ù„ Ù‡Ú©ØªØ§Ø± Ú©Ø´Øª</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-50 p-4 rounded-xl border border-yellow-200">
                        <h4 class="font-bold text-yellow-800 mb-2">ğŸ† ÙˆØ¶Ø¹ÛŒØª Ø¹Ù…Ù„Ú©Ø±Ø¯</h4>
                        <div class="text-sm text-yellow-700">
                            ${reports.length > 10 ? 'Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¹Ø§Ù„ÛŒ! Ø¨ÛŒØ´ Ø§Ø² 10 Ú¯Ø²Ø§Ø±Ø´ Ø«Ø¨Øª Ø´Ø¯Ù‡' : 
                              reports.length > 5 ? 'Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø®ÙˆØ¨! Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ù‡ÛŒØ¯' : 
                              reports.length > 0 ? 'Ø´Ø±ÙˆØ¹ Ø®ÙˆØ¨ÛŒ Ø¯Ø§Ø´ØªÙ‡â€ŒØ§ÛŒØ„1ï¿½7' : 'Ù‡Ù†ÙˆØ² Ú¯Ø²Ø§Ø±Ø´ÛŒ Ø«Ø¨Øª Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ„1ï¿½7'}
                        </div>
                    </div>
                </div>
            `;
            
            hideAllPages();
            document.getElementById('menuPages').classList.remove('hidden');
            document.getElementById('userInfoPage').classList.remove('hidden');
            closeSidebar();
        }

        function showPerformance() {
            hideAllPages();
            document.getElementById('menuPages').classList.remove('hidden');
            document.getElementById('performancePage').classList.remove('hidden');
            closeSidebar();
            
            // ØªØ§Ø®ÛŒØ± Ú©ÙˆØªØ§Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ù‡
            setTimeout(() => {
                generateCharts();
            }, 500);
        }

        function showSupport() {
            hideAllPages();
            document.getElementById('menuPages').classList.remove('hidden');
            document.getElementById('supportPage').classList.remove('hidden');
            closeSidebar();
        }

        function showBackup() {
            hideAllPages();
            document.getElementById('menuPages').classList.remove('hidden');
            document.getElementById('backupPage').classList.remove('hidden');
            closeSidebar();
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†Û„1ï¿½7 Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ¹Ù„ÛŒ
            updateBackupInfo();
        }
        
        function updateBackupInfo() {
            const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
            const totalHectares = reports.reduce((sum, report) => sum + parseFloat(report.todayHectares || 0), 0);
            
            const reportsCountEl = document.getElementById('currentReportsCount');
            const totalHectaresEl = document.getElementById('currentTotalHectares');
            
            if (reportsCountEl) reportsCountEl.textContent = reports.length;
            if (totalHectaresEl) totalHectaresEl.textContent = totalHectares.toFixed(1);
        }

        function backToMain() {
            hideAllPages();
            document.getElementById('mainPage').classList.remove('hidden');
        }

        function hideAllPages() {
            document.getElementById('mainPage').classList.add('hidden');
            document.getElementById('menuPages').classList.add('hidden');
            document.getElementById('userInfoPage').classList.add('hidden');
            document.getElementById('performancePage').classList.add('hidden');
            document.getElementById('supportPage').classList.add('hidden');
            document.getElementById('backupPage').classList.add('hidden');
        }

        // ØªÙ…Ø§Ø³ Ø¨Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ
        function callSupport() {
            const phoneNumber = '09168231334';
            const confirmMessage = `Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ„1ï¿½7 Ø¨Ø§ Ø´Ù…Ø§Ø±Ù‡ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ØªÙ…Ø§Ø³ Ø¨Ú¯ÛŒØ±ÛŒØ¯ØŸ\n\nğŸ“± ${phoneNumber}\nğŸ‘¤ Ù…Ø­Ù…Ø¯ Ú©Ø¹Ø¨`;
            
            if (confirm(confirmMessage)) {
                window.location.href = `tel:${phoneNumber}`;
                showToast('Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ù‚Ø±Ø§Ø±ÛŒ ØªÙ…Ø§Ø³...');
            }
        }

        // ØªÙˆÙ„ÛŒØ¯ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
        function generateCharts() {
            const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
            const performanceContent = document.getElementById('performanceContent');
            
            if (reports.length === 0) {
                performanceContent.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-8xl mb-6">ğŸ“Š</div>
                        <h3 class="text-xl font-bold text-gray-700 mb-3">Ù‡Ù†ÙˆØ² Ú¯Ø²Ø§Ø±Ø´ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡</h3>
                        <p class="text-gray-500 mb-6">Ø¨Ø±Ø§ÛŒ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ØŒ Ø§Ø¨ØªØ¯Ø§ Ú¯Ø²Ø§Ø±Ø´â€ŒÙ‡Ø§ÛŒÛ„1ï¿½7 Ø«Ø¨Øª Ú©Ù†ÛŒØ¯</p>
                        <button onclick="backToMain()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-medium">
                            ğŸ“ Ø«Ø¨Øª Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø¯ÛŒØ¯
                        </button>
                    </div>
                `;
                return;
            }
            
            // Ø¨Ø§Ø²Ø³Ø§Ø²ÛŒ Ù…Ø­ØªÙˆØ§ÛŒ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§
            performanceContent.innerHTML = `
                <div class="space-y-6">
                    <div class="bg-gradient-to-r from-green-50 to-green-100 p-6 rounded-xl border border-green-200">
                        <h3 class="text-lg font-bold mb-4 text-center text-green-800">ğŸ“ˆ Ø±ÙˆÙ†Ø¯ Ú©Ø´Øª Ù‡Ú©ØªØ§Ø±</h3>
                        <div style="height: 300px; position: relative;">
                            <canvas id="hectareChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200">
                        <h3 class="text-lg font-bold mb-4 text-center text-blue-800">â„1ï¿½7 Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø± Ø±ÙˆØ²Ø§Ù†Ù‡</h3>
                        <div style="height: 300px; position: relative;">
                            <canvas id="hoursChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-gradient-to-r from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200">
                        <h3 class="text-lg font-bold mb-4 text-center text-purple-800">ğŸ“Š Ø®Ù„Ø§ØµÙ‡ Ø¢Ù…Ø§Ø±</h3>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-green-600">${reports.reduce((sum, r) => sum + parseFloat(r.todayHectares || 0), 0).toFixed(1)}</div>
                                <div class="text-sm text-gray-600">Ú©Ù„ Ù‡Ú©ØªØ§Ø±</div>
                            </div>
                            <div class="bg-white p-4 rounded-lg text-center">
                                <div class="text-2xl font-bold text-blue-600">${reports.length}</div>
                                <div class="text-sm text-gray-600">ØªØ¹Ø¯Ø§Ø¯ Ú¯Ø²Ø§Ø±Ø´</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // ØªØ§Ø®ÛŒØ± Ú©ÙˆØªØ§Ù‡ Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø±Ù†Ø¯Ø± Ø´Ø¯Ù† Ø¹Ù†Ø§ØµØ±
            setTimeout(() => {
                try {
                    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ
                    if (window.hectareChart && typeof window.hectareChart.destroy === 'function') {
                        window.hectareChart.destroy();
                        window.hectareChart = null;
                    }
                    if (window.hoursChart && typeof window.hoursChart.destroy === 'function') {
                        window.hoursChart.destroy();
                        window.hoursChart = null;
                    }
                    
                    // Ù†Ù…ÙˆØ¯Ø§Ø± Ù‡Ú©ØªØ§Ø±
                    const hectareCanvas = document.getElementById('hectareChart');
                    if (hectareCanvas && hectareCanvas.getContext) {
                        const hectareCtx = hectareCanvas.getContext('2d');
                        if (!hectareCtx) {
                            console.error('Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù„1ï¿½7 context Ù†Ù…ÙˆØ¯Ø§Ø± Ù‡Ú©ØªØ§Ø± Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯');
                            return;
                        }
                        const hectareData = processHectareData(reports);
                        
                        window.hectareChart = new Chart(hectareCtx, {
                            type: 'line',
                            data: {
                                labels: hectareData.labels,
                                datasets: [{
                                    label: 'Ù‡Ú©ØªØ§Ø± Ú©Ø´Øª Ø´Ø¯Ù‡',
                                    data: hectareData.values,
                                    borderColor: 'rgb(34, 197, 94)',
                                    backgroundColor: 'rgba(34, 197, 94, 0.2)',
                                    tension: 0.4,
                                    fill: true,
                                    pointBackgroundColor: 'rgb(34, 197, 94)',
                                    pointBorderColor: 'white',
                                    pointBorderWidth: 2,
                                    pointRadius: 6
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: true,
                                        position: 'top',
                                        labels: {
                                            usePointStyle: true,
                                            padding: 20
                                        }
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Ù‡Ú©ØªØ§Ø±',
                                            font: {
                                                size: 14,
                                                weight: 'bold'
                                            }
                                        },
                                        grid: {
                                            color: 'rgba(0,0,0,0.1)'
                                        }
                                    },
                                    x: {
                                        title: {
                                            display: true,
                                            text: 'ØªØ§Ø±ÛŒØ®',
                                            font: {
                                                size: 14,
                                                weight: 'bold'
                                            }
                                        },
                                        grid: {
                                            color: 'rgba(0,0,0,0.1)'
                                        }
                                    }
                                }
                            }
                        });
                    }

                    // Ù†Ù…ÙˆØ¯Ø§Ø± Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø±
                    const hoursCanvas = document.getElementById('hoursChart');
                    if (hoursCanvas && hoursCanvas.getContext) {
                        const hoursCtx = hoursCanvas.getContext('2d');
                        if (!hoursCtx) {
                            console.error('Ù†Ù…ÛŒâ€ŒØªÙˆØ§Ù„1ï¿½7 context Ù†Ù…ÙˆØ¯Ø§Ø± Ø³Ø§Ø¹Ø§Øª Ø±Ø§ Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯');
                            return;
                        }
                        const hoursData = processHoursData(reports);
                        
                        window.hoursChart = new Chart(hoursCtx, {
                            type: 'bar',
                            data: {
                                labels: hoursData.labels,
                                datasets: [{
                                    label: 'Ø³Ø§Ø¹Ø§Øª Ú©Ø§Ø±',
                                    data: hoursData.values,
                                    backgroundColor: 'rgba(59, 130, 246, 0.8)',
                                    borderColor: 'rgb(59, 130, 246)',
                                    borderWidth: 2,
                                    borderRadius: 8,
                                    borderSkipped: false
                                }]
                            },
                            options: {
                                responsive: true,
                                maintainAspectRatio: false,
                                plugins: {
                                    legend: {
                                        display: true,
                                        position: 'top',
                                        labels: {
                                            usePointStyle: true,
                                            padding: 20
                                        }
                                    }
                                },
                                scales: {
                                    y: {
                                        beginAtZero: true,
                                        title: {
                                            display: true,
                                            text: 'Ø³Ø§Ø¹Øª',
                                            font: {
                                                size: 14,
                                                weight: 'bold'
                                            }
                                        },
                                        grid: {
                                            color: 'rgba(0,0,0,0.1)'
                                        }
                                    },
                                    x: {
                                        title: {
                                            display: true,
                                            text: 'ØªØ§Ø±ÛŒØ®',
                                            font: {
                                                size: 14,
                                                weight: 'bold'
                                            }
                                        },
                                        grid: {
                                            color: 'rgba(0,0,0,0.1)'
                                        }
                                    }
                                }
                            }
                        });
                    }
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§:', error);
                    performanceContent.innerHTML = `
                        <div class="text-center py-8">
                            <div class="text-6xl mb-4">âš ï¸</div>
                            <h3 class="text-lg font-semibold text-red-600 mb-2">Ø®Ø·Ø§ Ø¯Ø± Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆØ¯Ø§Ø±Ù‡Ø§</h3>
                            <p class="text-gray-500">Ù„Ø·ÙØ§Ù‹ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯</p>
                            <button onclick="generateCharts()" class="mt-4 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                                ğŸ”„ ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯
                            </button>
                        </div>
                    `;
                }
            }, 300);
        }

        function processHectareData(reports) {
            const dailyData = {};
            const officeData = {};
            
            reports.forEach(report => {
                const date = report.recordDate || 'Ù†Ø§Ù…Ø´Ø®Øµ';
                const office = report.office || 'Ù†Ø§Ù…Ø´Ø®Øµ';
                const hectares = parseFloat(report.todayHectares || 0);
                
                // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 Ú©Ù„
                if (!dailyData[date]) {
                    dailyData[date] = 0;
                }
                dailyData[date] += hectares;
                
                // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 Ù‡Ø± Ø§Ø¯Ø§Ø±Ù‡
                if (!officeData[office]) {
                    officeData[office] = {};
                }
                if (!officeData[office][date]) {
                    officeData[office][date] = 0;
                }
                officeData[office][date] += hectares;
            });
            
            // Ù…Ø±ØªØ¨ Ú©Ø±Ø¯Ù† ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø„1ï¿½7
            const sortedDates = Object.keys(dailyData).sort();
            
            return {
                labels: sortedDates,
                values: sortedDates.map(date => dailyData[date]),
                officeData: officeData
            };
        }

        function processHoursData(reports) {
            const dailyHours = {};
            const officeHours = {};
            
            reports.forEach(report => {
                const date = report.recordDate || 'Ù†Ø§Ù…Ø´Ø®Øµ';
                const office = report.office || 'Ù†Ø§Ù…Ø´Ø®Øµ';
                
                if (report.startTime && report.endTime) {
                    try {
                        const start = new Date(`2000-01-01 ${report.startTime}`);
                        const end = new Date(`2000-01-01 ${report.endTime}`);
                        let hours = (end - start) / (1000 * 60 * 60);
                        
                        // Ø§Ú¯Ø± Ø³Ø§Ø¹Øª Ù¾Ø§ÛŒØ§Ù† Ú©Ù…ØªØ± Ø§Ø² Ø´Ø±ÙˆØ¹ Ø¨Ø§Ø´Ø¯ (Ø´Ø¨ Ú©Ø§Ø±ÛŒ)
                        if (hours < 0) {
                            hours += 24;
                        }
                        
                        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 Ú©Ù„
                        if (!dailyHours[date]) {
                            dailyHours[date] = 0;
                        }
                        dailyHours[date] += hours;
                        
                        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§Û„1ï¿½7 Ù‡Ø± Ø§Ø¯Ø§Ø±Ù‡
                        if (!officeHours[office]) {
                            officeHours[office] = {};
                        }
                        if (!officeHours[office][date]) {
                            officeHours[office][date] = 0;
                        }
                        officeHours[office][date] += hours;
                    } catch (error) {
                        console.log('Ø®Ø·Ø§ Ø¯Ø± Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø§Ø¹Ø§Øª:', error);
                    }
                }
            });
            
            // Ù…Ø±ØªØ¨ Ú©Ø±Ø¯Ù† ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø„1ï¿½7
            const sortedDates = Object.keys(dailyHours).sort();
            
            return {
                labels: sortedDates,
                values: sortedDates.map(date => Math.round(dailyHours[date] * 10) / 10),
                officeData: officeHours
            };
        }

        // Ø¨Ú©Ø§Ù¾ Ùˆ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ
        function createBackup() {
            try {
                const reports = JSON.parse(localStorage.getItem('farmReports') || '[]');
                const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
                
                const allData = {
                    user: user,
                    reports: reports,
                    backupDate: new Date().toISOString(),
                    version: '1.0',
                    totalReports: reports.length,
                    totalHectares: reports.reduce((sum, report) => sum + parseFloat(report.todayHectares || 0), 0)
                };
                
                const dataStr = JSON.stringify(allData, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                const fileName = `Ú©Ø´Ø§ÙˆØ±Ø²ÛŒ-Ø¨Ú©Ø§Ù¾-${new Date().toISOString().split('T')[0]}.json`;
                link.download = fileName;
                link.click();
                
                showToast(`ÙØ§ÛŒÙ„ Ø¨Ú©Ø§Ù¾ Ø¨Ø§ ${reports.length} Ú¯Ø²Ø§Ø±Ø´ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯`);
                
                // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† URL Ø¨Ø±Ø§ÛŒ Ø¢Ø²Ø§Ø¯Ø³Ø§Ø²ÛŒ Ø­Ø§ÙØ¸Ù‡
                setTimeout(() => {
                    URL.revokeObjectURL(link.href);
                }, 100);
                
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø§ÛŒØ¬Ø§Ø¯ Ø¨Ú©Ø§Ù¾:', error);
                showToast('Ø®Ø·Ø§ Ø¯Ø± Ø§ÛŒØ¬Ø§Ø¯ ÙØ§ÛŒÙ„ Ø¨Ú©Ø§Ù¾', 'error');
            }
        }

        function restoreBackup() {
            const fileInput = document.getElementById('backupFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showToast('Ù„Ø·ÙØ§Ù‹ ÙØ§ÛŒÙ„ Ø¨Ú©Ø§Ù¾ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            
            if (!file.name.endsWith('.json')) {
                showToast('Ù„Ø·ÙØ§Ù‹ ÙØ§ÛŒÙ„ JSON Ù…Ø¹ØªØ¨Ø± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const backupData = JSON.parse(e.target.result);
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª ÙØ§ÛŒÙ„ Ø¨Ú©Ø§Ù¾
                    if (!backupData.reports || !Array.isArray(backupData.reports)) {
                        showToast('ÙØ§ÛŒÙ„ Ø¨Ú©Ø§Ù¾ Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª', 'error');
                        return;
                    }
                    
                    // ØªØ£ÛŒÛŒØ¯ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ
                    const currentReports = JSON.parse(localStorage.getItem('farmReports') || '[]');
                    const confirmMessage = `Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ\n\nØ§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ¹Ù„ÛŒ: ${currentReports.length} Ú¯Ø²Ø§Ø±Ø´\nØ§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ú©Ø§Ù¾: ${backupData.reports.length} Ú¯Ø²Ø§Ø±Ø´\n\nØªÙ…Ø§Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ¹Ù„ÛŒ Ø­Ø°Ù Ùˆ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ù…ÛŒâ€ŒØ´ÙˆØ„1ï¿½7.`;
                    
                    if (!confirm(confirmMessage)) {
                        return;
                    }
                    
                    // Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª
                    if (backupData.user && Object.keys(backupData.user).length > 0) {
                        localStorage.setItem('currentUser', JSON.stringify(backupData.user));
                    }
                    
                    localStorage.setItem('farmReports', JSON.stringify(backupData.reports));
                    
                    showToast(`Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ù…ÙˆÙÙ‚: ${backupData.reports.length} Ú¯Ø²Ø§Ø±Ø´ Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ Ø´Ø¯`);
                    
                    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†Û„1ï¿½7 ØµÙØ­Ù‡
                    calculateTotalHectares();
                    updateBackupInfo();
                    
                    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ÙÛŒÙ„Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ ÙØ§ÛŒÙ„
                    fileInput.value = '';
                    
                } catch (error) {
                    console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø²ÛŒØ§Ø¨ÛŒ:', error);
                    showToast('ÙØ§ÛŒÙ„ Ø¨Ú©Ø§Ù¾ Ø¢Ø³ÛŒØ¨ Ø¯ÛŒØ¯Ù‡ ÛŒØ§ Ù†Ø§Ù…Ø¹ØªØ¨Ø± Ø§Ø³Øª', 'error');
                }
            };
            
            reader.onerror = function() {
                showToast('Ø®Ø·Ø§ Ø¯Ø± Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„', 'error');
            };
            
            reader.readAsText(file);
        }

        // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²Û„1ï¿½7 Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØµÙØ­Ù‡
        document.addEventListener('DOMContentLoaded', function() {
            checkAuth();
            updateConnectionStatus();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'973ff9eca129cb47',t:'MTc1NjAwODM3OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
